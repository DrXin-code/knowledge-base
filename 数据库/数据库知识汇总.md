# 一：数据库基本概念

1.**三级模式**：外模式（用户视图）、模式（全局视图）、、内模式

2.**数据**（Data) :描述事物的符号记录称为数据。
	**数据库**(Data Base ,简称 **DB**):数据库是长期储存在计算机内的、有组织的、可共享的数据集合。
	**数据库系统**(Data Base System ,简称 DBS ) :数据库系统是指在计算机系统中引入数据库后的系统					  构成，一般由数据库、数据库管理系统（及其开发工具)、应用系统、数据库管理成。
	**数据库管理系统**(DataBase Management System ,简称**DBMS)**:数据库管理系统是位于用户与操作系统之间的一层数据管理软件，用于科学地组织和存储数据、高效地获取和维护数据。

​	DBS包括DB和DBMS和DBA

![image-20230528172057591](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230528172057591.png)

​	5.**DBMS功能**：数据库定义功能ddl、数据操纵功能dml、数据库运行控制功能dcl、数据组织存储和管理功能、数据库的建立和维护功能

6.![image-20230529232102284](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230529232102284.png)

7.![image-20230530001553608](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530001553608.png)

8.**三个发展阶段**![image-20230530154714247](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530154714247.png)

9.![image-20230530163521996](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530163521996.png)

# 二：关系代数 

1.**三类完整性约束**：实体完整性、参照完整性和用户定义的完整性

2.**五个基本关系模型查询操作**：选择 、投影、并、差、笛卡儿积

​	**专门的运算关系包括选择、投影、连接、除运算**

3.关系是一种数学结构，被定义为一个**笛卡尔积的子集**

4.一个关系就是一个二维表，但并不是每一个二维表都是一个关系

5.关系有且仅有一种记录类型，不能有多种记录类型。

# 三：数据库设计

1.**数据库设计六个阶段**：需求分析阶段、概念设计阶段、逻辑设计阶段（模式、视图、事务）、数据库物理设计阶段（索引、约束）、数据库实施阶段、数据库运行和维护阶段

2.**逻辑结构设计的任务**就是为概念结构设计阶段生成的全局E-R视图，转换为特定DBMS 产品所能支持的数据模型。

3.**概念设计**：正确是（C）。 A．概念结构设计是应用程序模块设计的基础 B．概念结构设计只应用到数据字典 C．概念结构设计与具体DBMS无关 D．概念结构设计就是确定关系模式概念结构设计是指根据数据流图和数据字典，分析总结出实体及联系，为下一步逻辑结构设计做准备。应用程序模块设计依据的是应用需求，与数据库结构设计没有直接联系，故选项A错误：概念结构设计应用到数据字典和数据流图，选项B没有提及数据流图，故也是错误的；概念结构设计注重对现实的描述，与DBMS的结合是逻辑结构设计时考虑的，故选项C正确：确定关系模式是逻辑结构设计的内容而非概念结构设计的任务，故选项D是错误的。

4.**两层映像:**外模式/模式映像->逻辑独立性       模式/内模式映像->物理独立性

5.**三级模式**：外模式:视图

​						模式：逻辑模式，逻辑结构和特征的描述

​						内模式：内部物理存储结构

6.**数据库系统核心**：数据库管理系统

7.**操作异常**：插入异常、删除异常、修改异常

# 四：ER

1.合并分ER图冲突：属性冲突、命名冲突、结构冲突

2.**实体完整性：**每个关系应该有\**一个主码\**（可唯一标识表中的一条记录），每个元组的主码值惟一确定该元									组**主属性**（不是主码）都不能取空值

3.1：1联系的转换方法:1:1联系可以转换为一个独立的关系模式，也可以与任意一端对应的关系模式合并。

- 如果转换为一个独立的关系模式，则与该联系相连的各实体的主码以及联系本身的属性均转换为关系的属性，每个实体的主码均是该关系的[候选码](https://so.csdn.net/so/search?q=候选码&spm=1001.2101.3001.7020)。
- 如果与某一端对应的关系模式合并，则需要在该关系模式的属性（**做外码**）中加入另一个关系模式的主码和联系本身的属性。

4.1:n联系的转换方法: 1:n联系可以转换为一个独立的关系模式，也可以与n端对应的关系模式合并。

- 若转换为一个独立的关系模式，则与该联系相连的各实体的主码以及联系本身的属性均转换为关系的属性，而关系的主码为n端实体的主码。
- 若与n端关系模式合并，则在n端实体集中增加新属性，新属性由联系对应的1端实体集的主码和联系自身的属性构成，而关系模式的主码不变。

5.m:n联系的转换方法：与该联系相连的各实体的码以及联系本身的属性均转换为关系的属性。而关系的码为各实体码的组合。

# 五：规范化

1.<img src="file:///C:\Users\huang\Documents\Tencent Files\1411423062\Image\C2C\3H`U{6$XE0AJHT_20$~ZN]G.png" alt="img" style="zoom: 67%;" />

2.<img src="file:///C:\Users\huang\Documents\Tencent Files\1411423062\Image\C2C\3NXTWF{IJ}1EDE5SL[~YBZE.png" alt="img"  />

3.**关系模式中若属性都是主属性**，则不会存在非主属性对码的部分函数依赖，也不会存在非主属性对码的传递函数依赖，消除这两种分别代表达到第二范式和第三范式 (这里的码指的是候选码)。 若关系模式中全都是主属性，则至少是第三范式，若想达到BC范式，还要消除主属性对码的部分函数依赖和传递函数依赖。

4.候选码，简称为码

​	包含在任何一个码中的属性成为主属性（主属性即码的并集）

5：**BCNF**:不存在着主属性对于码的部分函数依赖与传递函数依赖

6.平凡函数依赖：y∈x,x->y

​	增广性：x->y—-xz->yz(xz表示x和z的并集)

​	分解性：xz->y  xz->z

​	a->b—-a->ab(aa=a)

​	a是ab的子集

7.![image-20230531191713656](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531191713656.png)

8.![image-20230531194022760](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531194022760.png)

![image-20230531194040833](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531194040833.png)

![image-20230531194219480](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531194219480.png)

# 六：SQL

1.WHERE 子句作用于表和视图，HAVING 子句作用于组,HAVING 子句总是包含聚集函数,having一般跟在group by之后

2.SQL**语句分类**:数据定义语言DDL、数据查询语言DQL、数据操纵语言DML、数据控制功能DCL

3.SQL的**六大约束**:主键约束、外键约束、唯一性约束、检查约束、默认约束、非空约束。

4.SQL的三中连接：内连接、外连接、交叉连接（笛卡尔积）

5.int表示整数，decimal（m，n）表示n精度小数，m为总长度，n为小数点后的长度

6.外码声明：foreign key（属性名）references  表名（属性名）

7.oder by 属性 asc/desc 放最后

8.使用group by时，select后面出现的属性要么在by后面也要出现，要么就以聚集函数的方式存在

9.数据修改

​	（1）插入

​			insert into  表（属性列表） values （想要插进去的属性列表）

​	（2）更新

​			update 表 set 要修改的东西 where

​	（3）删除

​				delete from 表 where

10. 视图的构造基于基本表或视图，是虚表  

    ​    数据库只储存视图的定义，不存放视图中的数据

    ​	基本表中的数据改变，视图中的数据随之改变

    ​     视图可以进行基本操作，但对更新操作有限制

11. **聚集索引**：索引项顺序与表中记录的物理顺序一致 ➢ 一个基本表上最多只能建立一个聚集索引

12. **单列即非聚集 复合即聚集** ![image-20230529194530228](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230529194530228.png)

![image-20230529194543492](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230529194543492.png)

13.数据库：create database 、 alter database、 drop database

​		表         ：create table       alter table（add、drop） drop table

​		数据     ：见上

​		视图： create view  as 

14.![image-20230530160557915](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530160557915.png)

用这些通配符的时候，**LIKE**，比如**姓张**![image-20230530160748726](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530160748726.png)

15.左外连接，显示左边的全部行，右边没有与其匹配的则显示null

16.大于等于分开写

17.![image-20230530163407986](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530163407986.png)

18.between and包括上下界

19.主键为标识表中的唯一实体

20.![image-20230530163912368](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530163912368.png)

21. 一个表只能有一个聚集 索引 ，可以有多个非聚集索引
21. ![image-20230530164645716](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530164645716.png)
21. update 一般用in，直接在原表修改，不用连接

# 七：事务与控制

1.**事务的特性**ACID：原子性 （Atomicity）一致性 （Consistency）隔离性 （Isolation）持续性 （Durability）

原子性指：事务包含的所有操作要么全部被执行，要么都不执行；一致性指：事务的执行结果必须使数据库从一个一致性状态转换到另一个一致性状态，一致性状态是指数据库中的数据满足完整性约束；隔离性是指：在事务被提交以前，其操作结果对于其他事务不可见；持续性指：一旦事务提交成功，其对数据库中数据的改变是永久的，即使因数据库故障而受到破坏，DBMS也能恢复。

2.**两阶段封锁协议**：<u>*保证可串行性</u>*（不可反推、充分条件），并不保证不会发生死锁，并不保证不会发生级联回滚*

***严格两阶段封锁协议**：除要求满足两段锁协议规定外，还要求事务的排它锁必须在事务提交之后释放。*<u>解决级联回滚问题 、 避免了脏读和丢失修改的问题</u>

***强两段锁协议**：除要求满足两段锁协议规定外，还要求事务的所有锁都必须在事务提交之后释放。  <u>*<u>进一步解						        决数据项不能重复读的问题*</u></u>

3.事务日志的用途是：数据恢复

4.并发控制的主要机制：封锁

5.![image-20230530162735197](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530162735197.png)

6.**满足冲突可串行性，一定满足 可串行性！可串行性 不一定满足 冲突可串行性**

7.![image-20230531200928823](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531200928823.png)

8.![image-20230531201445090](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230531201445090.png)

9.**一级封锁协议内容**：事务T在修改数据对象之前必须对其加X锁，直到事务结束。简单来说就是不能同时写，解决了丢失更新问题
**二级封锁协议内容**：在一级封锁协议的基础上，另外加上事务T在读取数据R之前必须先对其加S锁，读完后释放S锁。简单来说就是我写的时候你不可以读，这样你就读不到无效数据，解决读脏数据问题。二级封锁协议在读取数据之后，立即释放S锁（也就是说事务T在提交之前仍有可能其他事务对R进行修改），所以它仍然不能防止“不可重读”数据。

**三级封锁协议内容**：在一级封锁协议的基础上，另外加上事务T在读取数据R之前必须先对其加S锁，读完后并不释放S锁，而直到事务T结束才释放。

一级封锁 写的时候其他人不能写

二级封锁 写的时候其他人不能写，写的时候其他人不能读

三级封锁 写的时候其他人不能写，写的时候其他人不能读，读的时候其他人不能写

10.![image-20230601113431464](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230601113431464.png)

# 八：故障恢复

1.当数据库被破坏后，如果事先保存了**数据库副本**和**日志文件**就有可能恢复数据库。

2.恢复策略：正像扫描日志文件，找出在故障发生前已经提交的事务，将其事务标识记入REDO队列，同时找出故障发生时尚未完成的事务，将其事务标识记入UNDO 队列;对UNDO队列中的各个事务进行撤销处理;对REDO队列中的各个事务进行重做处理

3. 数据库系统中常见的**四种故障**主要有事务内部的故障、系统故障、介质故障以及计算机病毒故障
3. ![image-20230601153739909](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230601153739909.png)

# 九：安全

1.SQL通过GRANT和 REVOKE命令进行权限控制。GRANT命令向用户授予权限，而REVOKE命令将权限回收。

2.![image-20230530233135663](C:\Users\huang\AppData\Roaming\Typora\typora-user-images\image-20230530233135663.png)
